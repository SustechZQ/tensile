2020年 07月 16日 星期四 12:02:11 CST

文件说明

由于原始数据是用Tab分割的，用编译器打开可以看到第一行数据和最后一行数据中间有缺失，
数据格式不是方阵，不便于处理，就先在连续两个Tab中间增加拉数字"-10000"
原始数据后2列有效数据和前四列之间的间距不等，用程序进行列处理，
将有效的6列数据处理存储在 data_out/out2 中

====================================================================================================
====================================================================================================
README     说明文档
first.sh   shell脚本
calc.f95   Fortran源代码文件
calc       由Fortran源代码文件编译出来的可执行文件
data_in    输入文件，原始数据存储在这个文件内
           注意：文件中有效的数字有多列，后2列为需要使用的数据
                 原始数据只能用Tab来分割数据
                 原始数据第1行为非数据行，其余行都必须是数据行
                 原始数据第1行的后两列数据的标题为strain和stress（不区分大小写，不区分顺序）
data_out   输出文件,有4个子文件夹和3个子文件
           out        存储通过脚本处理的原始数据，删除了原始数据第一行(非数据行)
                      原始数据用Tab分割，在连续两个Tab之间增加数字"-10000"
                      将第一行数据（对应原始数据第二行）和最后一行数据中缺失的数据补全，方便程序处理
           out2       Fortran程序处理后的数据,只保存了数据的有效部分（对应原始数据的前4列和后面2列有效数据）
           fit_line1  对直线L1进行线性回归用的数据
           fit_line6  对直线L6进行线性回归用的数据
           info.txt   存储的是原始数据总文件个数，文件名，数据行数，数据列数
                      此文件第一行为原始数据的总个数 n，这个文件的总行数为  3*n+1
                      此文件除了第一行外，其余数据都是三行一组，分别为
                            原始数据文件名
                            原始数据数据部分的行数(不包括第一行非数据行)
                            经过处理的数据列数(是 data_out/out 文件夹内的数据的列数)
           result_old.txt    老的坐标系下计算出来的结果
           result_new.txt    变换到新坐标系下的结果
                             这两个文件为结果输出文件
                             依次保存着 点O1，点a，点b的坐标，直线L1,L2,L3,L4,L6的斜率和截距
                             文件首行为每列数据的名称
                             文件内容是两行一组，上一行文件名，下一行是这个文件对应的16个结果值
====================================================================================================
====================================================================================================
必要文件：
data_in    里面必须有数据，里面没有数据，程序会提示
first.sh   可执行脚本，如果此脚本没有执行权限，请增加执行权限，或用shell命令执行
           方式1：增加可执行去权限
                  chmod  +x  first.sh
                  ./firsh
           方式2：
                  sh  first.sh
二选一的文件：
calc.f95
calc
           这两个文件必须至少有1个，推荐保留源代码文件calc.f95
           如果缺失两个文件，first.sh脚本kepi正常执行，并给出需要这两个源代码的提示
           但是，没有这两个文件，数据无法处理计算，得不到想要的转折点
====================================================================================================
====================================================================================================
不需要的文件：
data_out   此文件在程序first.sh脚本执行的时候会自动生成，有没有这个文件对程序没有任何影响
====================================================================================================
====================================================================================================
输出文件：
result_old.txt
result_new.txt
           都在data_out目录中
====================================================================================================
====================================================================================================
计算原理：
1.先将数据处理成程序方那改变处理的矩阵形式
2.得到要处理的两列数据
3.直线L1是数据斜率最大的区段，先用两点求斜率的方式，把整个数据的连续两点的斜率对比一下，找到最大值
4.在这个最大值上下各选取5个点，共计11个点，用线性回归的方式，求直线方程，则可得到直线L1
5.直线L2是水平线，找到最低点，和L1可以得到点O1的坐标，直线L5的方程不用求解
6.直线L3的方程是点O1和最大值点b的连线方程
7.直线L4和直线L3斜率相等，直线L4过点a，点a是距离直线L3最远的点，可以得到点a坐标，可知直线L4
8.求解直线L1所选用的数据区段和直线L6所选用的区段关于点a对称，可以得到直线L6数据区段
9.根据数据区段，线性回归得到直线L6
10.以上结果都是在原始坐标系中计算，用坐标变换的方式可以得到在新坐标系中的结果(以点O1为新原点)
====================================================================================================
====================================================================================================
注意事项：
1.原始数据的文件名不要太长，建议不超过25个字符，如果需要处理的文件名很长，
  请把源代码calc.f95中所有"character"后面的括号中的数字都调大，大小为需要的长度+15
2.整个文件的文件结构不要改变，除了原始数据可以自己定名字，以及first.sh脚本的可以重命名，
  不要改变其他任何文件的名称及相对位置结构
3.源代码calc.f95的第147行和第148行设置了单位变化，根据需要设置倍率，调整单位



